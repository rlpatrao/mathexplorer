var C=Math.ceil(15),_=20,G=260,A=60,c=0,l=null,r=document.getElementById("board"),a=document.getElementById("ball"),m=document.getElementById("table-select"),g=document.getElementById("start-button"),w=document.getElementById("stop-button"),f=document.getElementById("speed-slider"),B=document.getElementById("speed-label"),L=document.getElementById("product-display"),S=document.getElementById("volume-slider"),H=document.getElementById("volume-label"),u=document.getElementById("background-audio");if(!r||!a||!m||!g||!w||!f||!B||!L||!S||!H||!u)throw new Error("Expected application elements were not found in the DOM.");var h=new Map,b=new Set,I=new Map;function $(){b.forEach(e=>{e.classList.remove("visited"),e.classList.remove("active")}),b.clear(),l=null,x()}function N(){let e=Math.floor(Math.random()*360);return{runColor:`hsla(${e}, 85%, 68%, 0.95)`,runShadow:`hsla(${e}, 80%, 35%, 0.35)`,runShadowStrong:`hsla(${e}, 82%, 32%, 0.45)`,ballLight:`hsla(${e}, 95%, 88%, 0.85)`,ballBorder:`hsla(${e}, 85%, 65%, 0.6)`,ballGlow:`hsla(${e}, 85%, 52%, 0.4)`}}function V(e){r.style.setProperty("--run-color",e.runColor),r.style.setProperty("--run-color-shadow",e.runShadow),r.style.setProperty("--run-color-shadow-strong",e.runShadowStrong),r.style.setProperty("--ball-color-light",e.ballLight),r.style.setProperty("--ball-border-color",e.ballBorder),r.style.setProperty("--ball-glow",e.ballGlow)}function F(e){var n;let t=(n=I.get(e))!=null?n:null;return t||(t=N(),I.set(e,t)),V(t),t}function O(){u.pause(),u.currentTime=0}async function W(){u.pause(),u.currentTime=0,u.load(),D();try{await u.play()}catch(e){console.warn("Background audio play request was blocked or failed:",e)}}function D(){let e=E(),t=Math.pow(e,.8),n=e<=.01?0:.15+t*.75;u.volume=Math.max(0,Math.min(1,n))}function E(){let e=Number(S.value);return Number.isFinite(e)?Math.max(0,Math.min(1,e/100)):A/100}function x(){L.textContent=""}function U(e,t,n){L.textContent=`${e} x ${t} = ${n}`}function q(){let e=new Set;Array.from(m.options).forEach(t=>{e.add(t.value)});for(let t=1;t<=_;t+=1)if(!e.has(String(t))){let n=document.createElement("option");n.value=String(t),n.textContent=String(t),m.append(n)}}function X(){r.innerHTML="",h.clear(),$(),r.style.setProperty("--grid-columns",String(C)),r.style.setProperty("--grid-rows",String(10));let e=document.createDocumentFragment();for(let t=1;t<=150;t+=1){let n=document.createElement("div");n.className="cell",n.dataset.value=String(t),n.textContent=String(t),e.append(n),h.set(t,n)}e.append(a),r.append(e)}function R(){let t=(Number(f.value)/1e3).toFixed(1);B.textContent=`${t}s`}function p(){return Number(f.value)}function k(){let e=Math.round(E()*100);H.textContent=`${e}%`,D()}function M(e){g.disabled=e,w.disabled=!e}function y(e){if(l&&l!==e&&l.classList.remove("active"),!e){l=null,x();return}l=e,l.classList.add("visited"),l.classList.add("active"),b.add(l)}function d(e,t=!0){if(!e){a.classList.remove("visible");return}let n=t?p():0;a.style.setProperty("--hop-duration",`${n}ms`);let o=e.offsetWidth,s=e.offsetHeight;a.style.width=`${o}px`,a.style.height=`${s}px`;let i=e.offsetLeft,v=e.offsetTop;a.classList.add("visible"),a.style.transform=`translate3d(${i}px, ${v}px, 0)`,t||requestAnimationFrame(()=>{a.style.setProperty("--hop-duration",`${p()}ms`)})}function z(e,t,n){if(!("speechSynthesis"in window))return;let o=p()<1500,s=o?`${n}`:`${e} times ${t} is ${n}`,i=new SpeechSynthesisUtterance(s);i.lang="en-US",i.rate=o?1.05:.95,i.pitch=1.05,i.volume=Math.max(0,Math.min(1,E())),window.speechSynthesis.cancel(),window.speechSynthesis.speak(i)}function j(e){let t=[];for(let n=1;n<=12;n+=1){let o=e*n;if(o>150)break;t.push({multiplier:n,product:o})}return t}function P(e){return new Promise(t=>{window.setTimeout(t,e)})}function T(e){var t,n;M(!1),O(),y(null),e&&(a.classList.remove("visible"),(n=(t=window.speechSynthesis)==null?void 0:t.cancel)==null||n.call(t))}async function Y(e,t){var o;let n=j(e);y(null),d(null),await P(150);for(let s of n){if(t!==c)return;let i=(o=h.get(s.product))!=null?o:null;if(!i)continue;y(i),U(e,s.multiplier,s.product),d(i),z(e,s.multiplier,s.product);let v=p()+G;await P(v)}t===c&&T(!1)}function J(){var n,o;let e=Number(m.value);if(!Number.isFinite(e)||e<1)return;$(),d(null),F(e),W(),c+=1;let t=c;M(!0),(o=(n=window.speechSynthesis)==null?void 0:n.cancel)==null||o.call(n),Y(e,t).catch(s=>{console.error(s),T(!0)})}function K(){c+=1,T(!0)}function Q(){R(),l&&d(l,!1)}function Z(){k()}function ee(){l&&d(l,!1)}function te(){q(),X(),R(),k(),M(!1),g.addEventListener("click",J),w.addEventListener("click",K),f.addEventListener("input",Q),S.addEventListener("input",Z),window.addEventListener("resize",ee)}te();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").catch(e=>console.error("Service worker registration failed:",e))});
//# sourceMappingURL=main.js.map
